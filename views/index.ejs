<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Submit a Link</title>
</head>

<body>
    <h1>Submit a Link</h1>
    <form id="urlForm">
        <label for="url">Enter a URL:</label>
        <input type="text" id="url" name="url" placeholder="https://example.com" required>
        <button type="submit">Submit</button>
    </form>

    <!-- This will display the result -->
    <div id="result"></div>

    <script>
        // Handle form submission via AJAX
        document.getElementById('urlForm').addEventListener('submit', async function (event) {
            event.preventDefault(); // Prevent form from submitting the traditional way

            const urlInput = document.getElementById('url').value;

            try {
                // Send the form data via AJAX using fetch
                const response = await fetch('/submit', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ url: urlInput })
                });

                const result = await response.json();

                console.log(result)
                const img = document.createElement('img');
                img.src = result.url; 
                img.alt = 'Generated Image';
                img.style.maxWidth = '400px';

                const downloadLink = document.createElement('a');
                downloadLink.href = result.url;
                downloadLink.download = 'downloaded_image.jpg'; 
                downloadLink.innerHTML = '<button>Download Image</button>';

                const resultDiv = document.getElementById('result');
                resultDiv.innerHTML = '';  
                resultDiv.appendChild(img);
                resultDiv.appendChild(downloadLink);

            } catch (error) {
                console.error('Error:', error);
                document.getElementById('result').innerHTML = 'Error submitting the form!';
            }
        });
    </script>
</body>

</html>